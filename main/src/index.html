<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <!-- FIX: Add a Content Security Policy to address the Electron security warning. -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'">
    <title>SoundLink</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="title-bar">
        <div class="title-bar-title" aria-live="polite">
            <span class="title-bar-brand">SoundLink</span>
            <span class="title-bar-dot">â€¢</span>
            <span id="title-bar-track" class="title-bar-track">Nothing playing</span>
        </div>
        <div class="title-bar-controls">
            <button id="close-btn" class="title-bar-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
        </div>
    </div>

    <div id="toast-notification" class="toast-notification hidden">
        <div id="toast-icon" class="toast-icon"></div>
        <div class="toast-content">
            <p id="toast-title" class="toast-title"></p>
            <p id="toast-message" class="toast-message"></p>
        </div>
        <button id="toast-close-btn" class="toast-close-btn">&times;</button>
    </div>

    <div class="container">
        <div class="sidebar">
            <div class="nav-item active" id="home-btn" title="Home">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
            </div>
            <div class="nav-item" id="settings-btn" title="Settings">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06-.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
            </div>
            <div class="nav-item" id="player-btn" title="Player">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polygon points="10 8 16 12 10 16 10 8"></polygon></svg>
            </div>
            <div class="nav-item" id="console-btn" title="Console">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" y1="19" x2="20" y2="19"></line></svg>
            </div>
            <div class="nav-item" id="stats-btn" title="Statistics">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="20" x2="12" y2="10"></line><line x1="18" y1="20" x2="18" y2="4"></line><line x1="6" y1="20" x2="6" y2="16"></line></svg>
            </div>
            <div class="nav-item" id="notification-history-btn" title="Notifications">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path><path d="M13.73 21a2 2 0 0 1-3.46 0"></path></svg>
            </div>
            <div class="nav-item" id="help-btn" title="Help">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
            </div>
        </div>

        <div class="content">
            <div id="update-notification" class="update-notification hidden">
                <div class="update-notification-content">
                    <span class="update-notification-pill">Update</span>
                    <p id="update-message"></p>
                </div>
                <button id="restart-btn" class="hidden">Restart to Update</button>
            </div>
            <div id="loading-overlay" class="loading-overlay hidden">
                <div class="spinner"></div>
                <p>Loading Tracks...</p>
            </div>
            <!-- Home View -->
            <div id="home-view" class="view active-view">
                <div id="drop-zone" class="drop-zone">
                    <p>Drop Links Here</p>
                </div>
                <h1>SoundLink</h1>
                <p class="sub-heading">Spotify or YouTube Link</p>
                <div class="input-fields-container">
                    <div class="input-container">
                        <textarea id="links-input" placeholder="Paste your links here..."></textarea>
                        <button class="clear-btn hidden">&times;</button>
                    </div>
                    <div class="spotify-search-container">
                         <div class="search-bar-wrapper">
                            <div class="input-container">
                               <input type="text" id="spotify-search-input" placeholder="Search Spotify Playlists...">
                               <button class="clear-btn hidden">&times;</button>
                           </div>
                           <button id="spotify-filter-btn" title="Filter search type">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
                           </button>
                        </div>
                       <div id="spotify-filter-dropdown" class="spotify-filter-dropdown hidden">
                            <div class="spotify-filter-item active" data-type="playlist">Playlists</div>
                            <div class="spotify-filter-item" data-type="track">Tracks</div>
                            <div class="spotify-filter-item" data-type="album">Albums</div>
                            <div class="spotify-filter-item" data-type="all">All</div>
                       </div>
                       <div id="spotify-results-dropdown" class="spotify-results-dropdown hidden"></div>
                   </div>
                </div>
                <div class="button-container">
                    <button id="download-btn">Download</button>
                    <button id="cancel-btn" class="hidden">Cancel</button>
                    <button id="queue-download-btn" class="hidden">Download</button>
                </div>
            </div>

            <!-- Statistics View -->
            <div id="stats-view" class="view">
                <h1>Statistics</h1>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>Songs Downloaded</h3>
                        <p id="total-songs-stat">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Playlists Created</h3>
                        <p id="playlists-created-stat">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Downloads Initiated</h3>
                        <p id="downloads-initiated-stat">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Failed Items</h3>
                        <p id="songs-failed-stat">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Links Processed</h3>
                        <p id="links-processed-stat">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Spotify Links</h3>
                        <p id="spotify-links-stat">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>YouTube Links</h3>
                        <p id="youtube-links-stat">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Success Rate</h3>
                        <p id="success-rate-stat">0%</p>
                    </div>
                    <div class="stat-card">
                        <h3>Notifications Received</h3>
                        <p id="notifications-received-stat">0</p>
                    </div>
                </div>
                <button id="reset-stats-btn">Reset Statistics</button>
            </div>

            <!-- Settings View -->
            <div id="settings-view" class="view">
                <h1>Settings</h1>
                <div class="settings-tab-bar" id="settings-tab-bar">
                    <button class="settings-tab-btn active" data-settings-tab="download" type="button">Download</button>
                    <button class="settings-tab-btn" data-settings-tab="themes" type="button">Themes</button>
                    <button class="settings-tab-btn" data-settings-tab="playback" type="button">Playback</button>
                    <button class="settings-tab-btn" data-settings-tab="interface" type="button">Interface</button>
                    <button class="settings-tab-btn" data-settings-tab="library" type="button">Library</button>
                    <button class="settings-tab-btn" data-settings-tab="automation" type="button">Automation</button>
                    <button class="settings-tab-btn" data-settings-tab="maintenance" type="button">Maintenance</button>
                </div>

                <div class="settings-tab-panel" id="settings-panel-download">
                    <div class="settings-group">
                        <label for="clientId">Spotify Client ID</label>
                        <p class="setting-note">Used to authenticate Spotify API requests from the app.</p>
                        <div class="input-container">
                            <input type="text" id="clientId" placeholder="Enter your Spotify Client ID">
                            <button class="clear-btn hidden">&times;</button>
                        </div>
                    </div>
                    <div class="settings-group">
                        <label for="clientSecret">Spotify Client Secret</label>
                        <p class="setting-note">Private key paired with your Client ID for Spotify access.</p>
                        <div class="input-with-button input-container">
                            <input type="password" id="clientSecret" placeholder="Enter your Spotify Client Secret">
                            <button class="clear-btn hidden">&times;</button>
                            <button id="toggle-secret-btn">Show</button>
                        </div>
                    </div>
                    <div class="settings-group">
                        <label for="downloadsPath">Download Location</label>
                        <p class="setting-note">Folder where new audio downloads are saved.</p>
                        <div class="input-with-button">
                            <input type="text" id="downloadsPath" placeholder="Downloads will be saved here" readonly>
                            <button id="change-path-btn">Change</button>
                        </div>
                    </div>
                    <div class="settings-group">
                        <label for="playlistsPath">Playlists Folder</label>
                        <p class="setting-note">Root folder SoundLink scans for playlist directories.</p>
                        <div class="input-with-button">
                            <input type="text" id="playlistsPath" placeholder="Select a folder containing your playlists" readonly>
                            <button id="change-playlists-path-btn">Change</button>
                        </div>
                    </div>
                    <div class="settings-group">
                        <label for="spotify-search-limit">Spotify Search Result Limit</label>
                        <p class="setting-note">Maximum results returned per Spotify search request.</p>
                        <input type="number" id="spotify-search-limit" placeholder="1-50" min="1" max="50">
                    </div>
                    <div class="settings-group">
                        <label for="fileExtension">Audio File Extension</label>
                        <p class="setting-note">Output format used when extracting audio from downloads.</p>
                        <select id="fileExtension">
                            <option value="m4a">m4a (best quality)</option>
                            <option value="mp3">mp3</option>
                            <option value="wav">wav</option>
                            <option value="flac">flac</option>
                            <option value="ogg">ogg</option>
                            <option value="webm">webm</option>
                        </select>
                    </div>
                    <div class="settings-group">
                        <label for="downloadThreads">Download Threads</label>
                        <p class="setting-note">How many downloads can run in parallel.</p>
                        <input type="number" id="downloadThreads" placeholder="1-20" min="1">
                    </div>
                    <div class="settings-group">
                        <label for="durationToleranceSeconds">Duration Tolerance (seconds)</label>
                        <p class="setting-note">Allowed duration difference when matching search results.</p>
                        <input type="number" id="durationToleranceSeconds" placeholder="0-120" min="0" max="120">
                    </div>
                </div>

                <div class="settings-tab-panel hidden" id="settings-panel-themes">
                    <div id="favorites-container" class="hidden">
                        <h4 class="theme-section-header">Favorites</h4>
                        <div class="theme-grid" id="favorite-theme-grid"></div>
                    </div>
                    <h4 class="theme-section-header">All Themes</h4>
                    <div class="theme-grid" id="theme-grid"></div>
                    <h4 class="theme-section-header">Spectrogram</h4>
                    <div class="theme-settings-block">
                        <div class="settings-group spectrogram-color-group">
                            <label for="spectrogramColor">Spectrogram Color</label>
                            <p class="setting-note">Overrides automatic spectrogram tint with your selected color.</p>
                            <div class="spectrogram-color-input-wrap">
                                <input type="color" id="spectrogramColor" value="#3b82f6">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="settings-tab-panel hidden" id="settings-panel-playback">
                    <div class="settings-group toggle-switch-container">
                        <div class="setting-label-block">
                            <label for="normalizeVolume">Normalize Volume (slower)</label>
                            <p class="setting-note">Applies loudness normalization after download for more consistent playback.</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="normalizeVolume">
                            <span class="slider round"></span>
                        </label>
                    </div>
                    <div class="settings-group toggle-switch-container">
                        <div class="setting-label-block">
                            <label for="visualThemeSync">Visual Theme Sync</label>
                            <p class="setting-note">Syncs player visuals to the active app theme.</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="visualThemeSync">
                            <span class="slider round"></span>
                        </label>
                    </div>
                    <div class="settings-group sleep-timer-settings-group">
                        <div class="setting-label-block">
                            <label>Sleep Timer</label>
                            <p class="setting-note">Stops playback automatically after a selected duration.</p>
                        </div>
                        <div class="sleep-timer-controls">
                            <button id="sleep-timer-btn" type="button" class="secondary-btn settings-sleep-timer-btn" title="Sleep Timer">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                                <span>Set Sleep Timer</span>
                            </button>
                            <span id="sleep-timer-display" class="hidden settings-sleep-timer-display"></span>
                        </div>
                    </div>
                </div>

                <div class="settings-tab-panel hidden" id="settings-panel-interface">
                    <div class="settings-group toggle-switch-container">
                        <div class="setting-label-block">
                            <label for="hideRefreshButtons">Hide Refresh Buttons</label>
                            <p class="setting-note">Removes playlist/track refresh buttons from library views.</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="hideRefreshButtons">
                            <span class="slider round"></span>
                        </label>
                    </div>
                    <div class="settings-group toggle-switch-container">
                        <div class="setting-label-block">
                            <label for="hidePlaylistCounts">Hide Playlist Counts</label>
                            <p class="setting-note">Hides track-count labels shown next to playlists.</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="hidePlaylistCounts">
                            <span class="slider round"></span>
                        </label>
                    </div>
                    <div class="settings-group toggle-switch-container">
                        <div class="setting-label-block">
                            <label for="hideTrackNumbers">Hide Track Numbers</label>
                            <p class="setting-note">Removes numeric prefixes in track lists.</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="hideTrackNumbers">
                            <span class="slider round"></span>
                        </label>
                    </div>
                    <div class="settings-group toggle-switch-container">
                        <div class="setting-label-block">
                            <label for="hideSearchBars">Hide Search Bars</label>
                            <p class="setting-note">Hides playlist and track search inputs in library views.</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="hideSearchBars">
                            <span class="slider round"></span>
                        </label>
                    </div>
                    <div class="settings-group toggle-switch-container">
                        <div class="setting-label-block">
                            <label for="hideMixButtons">Hide Mix Buttons</label>
                            <p class="setting-note">Hides mix-generation actions from playlist screens.</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="hideMixButtons">
                            <span class="slider round"></span>
                        </label>
                    </div>
                    <div class="settings-group toggle-switch-container">
                        <div class="setting-label-block">
                            <label for="disableToasts">Disable Toast Popups</label>
                            <p class="setting-note">Turns off toast popups while still saving entries in Notification History.</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="disableToasts">
                            <span class="slider round"></span>
                        </label>
                    </div>
                </div>

                <div class="settings-tab-panel hidden" id="settings-panel-library">
                    <div class="settings-group toggle-switch-container">
                        <div class="setting-label-block">
                            <label for="enableSmartPlaylists">Enable Smart Playlists</label>
                            <p class="setting-note">Shows dynamic playlists like Recently Added and Most Played.</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="enableSmartPlaylists">
                            <span class="slider round"></span>
                        </label>
                    </div>
                    <div class="settings-group toggle-switch-container">
                        <div class="setting-label-block">
                            <label for="libraryPerformanceMode">Library Performance Mode</label>
                            <p class="setting-note">Uses metadata caching to speed up library loading.</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="libraryPerformanceMode">
                            <span class="slider round"></span>
                        </label>
                    </div>
                </div>

                <div class="settings-tab-panel hidden" id="settings-panel-automation">
                    <div class="settings-group toggle-switch-container">
                        <div class="setting-label-block">
                            <label for="autoCreatePlaylist">Automatically Create Playlist</label>
                            <p class="setting-note">Creates a playlist from the most recent successful download batch.</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="autoCreatePlaylist">
                            <span class="slider round"></span>
                        </label>
                    </div>
                    <div class="settings-group toggle-switch-container">
                        <div class="setting-label-block">
                            <label for="skipManualLinkPrompt">Skip Manual Link Prompt</label>
                            <p class="setting-note">Skips manual URL prompts when no link match is found.</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="skipManualLinkPrompt">
                            <span class="slider round"></span>
                        </label>
                    </div>
                </div>

                <div class="settings-tab-panel hidden" id="settings-panel-maintenance">
                    <div class="settings-group">
                        <label for="silenceTrimThresholdDb">Silence Trim Threshold (dB)</label>
                        <p class="setting-note">Lower values trim less silence; higher values trim more aggressively.</p>
                        <input type="number" id="silenceTrimThresholdDb" placeholder="10-80" min="10" max="80">
                    </div>
                    <div class="settings-group advanced-actions-container">
                        <div class="maintenance-action">
                            <button id="trim-library-silence-btn" class="secondary-btn">Trim Start/End Silence in Library</button>
                            <p class="setting-note">Scans your library and trims leading/trailing silence.</p>
                        </div>
                        <div class="maintenance-action">
                            <button id="update-ytdlp-btn">Update yt-dlp</button>
                            <p class="setting-note">Checks for newer yt-dlp binaries and updates if available.</p>
                        </div>
                        <div class="maintenance-action">
                            <button id="check-for-updates-btn">Check for App Updates</button>
                            <p class="setting-note">Manually checks for a new SoundLink version.</p>
                        </div>
                        <div class="maintenance-action">
                            <button id="clear-cache-btn" class="secondary-btn">Clear Link Cache</button>
                            <p class="setting-note">Removes saved link lookup cache entries.</p>
                        </div>
                        <div class="maintenance-action">
                            <button id="reset-settings-btn">Reset to Default</button>
                            <p class="setting-note">Restores all app settings to default values.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="advanced-settings-view" class="view hidden"></div>

            <!-- Player View -->
            <div id="player-view" class="view">
                <div class="player-content-area">
                    <!-- Left Panel: Playlists -->
                    <div class="player-playlists-panel">
                        <div class="panel-header">
                            <! -- Removed playlist text to clearly show the other text -->
                            <div class="playlist-stats" id="player-playlists-stats"></div>
                        </div>
                        <div class="playlist-search-container">
                            <div class="input-container">
                                <input type="text" id="player-playlist-search-input" placeholder="Search playlists...">
                                <button class="clear-btn hidden">&times;</button>
                            </div>
                        </div>
                        <div id="player-playlists-container" class="panel-list">
                            <!-- Player playlists will be loaded here -->
                        </div>
                    </div>
                    <!-- Right Panel: Tracks -->
                    <div class="player-tracks-panel">
                        <div class="panel-header">
                            <h2 id="player-tracks-header">Select a playlist</h2>
                            <div class="playlist-stats" id="player-tracks-stats"></div>
                        </div>
                        <div class="playlist-search-container">
                            <div class="input-container">
                                <input type="text" id="player-track-search-input" placeholder="Search tracks...">
                                <button class="clear-btn hidden">&times;</button>
                            </div>
                        </div>
                        <div id="player-tracks-container" class="panel-list">
                            <!-- Tracks for the selected playlist will be loaded here -->
                        </div>
                    </div>
                </div>
                <div class="player-controls-bar">
                    <canvas id="audio-spectrogram-overlay" aria-hidden="true"></canvas>
                    <div class="player-controls-glass"></div>
                    <div class="player-controls-content">
                        <div id="now-playing">Select a song to play</div>
                        <div class="progress-container">
                            <span id="current-time">0:00</span>
                            <div id="progress-bar-container">
                                <div id="progress-bar"></div>
                            </div>
                            <span id="total-duration">0:00</span>
                        </div>
                        <div class="player-controls-row">
                            <div class="left-controls">
                                <button id="shuffle-btn" class="shuffle-btn" title="Shuffle">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 3 21 3 21 8"></polyline><line x1="4" y1="20" x2="21" y2="3"></line><polyline points="16 21 21 21 21 16"></polyline><line x1="4" y1="4" x2="21" y2="21"></line></svg>
                                </button>
                                <button id="repeat-btn" class="shuffle-btn" title="Repeat">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m17 2 4 4-4 4"/><path d="M3 11v-1a4 4 0 0 1 4-4h14"/><path d="m7 22-4-4 4-4"/><path d="M21 13v1a4 4 0 0 1-4 4H3"/></svg>
                                </button>
                                <span id="repeat-status-text"></span>
                            </div>
                            <div class="main-controls">
                                <button id="prev-btn" class="player-btn">
                                    <svg class="player-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="19 20 9 12 19 4 19 20"></polygon><line x1="5" y1="19" x2="5" y2="5"></line></svg>
                                </button>
                                <button id="play-pause-btn" class="player-btn play-btn">
                                    <svg class="play-icon player-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M8 5v14l11-7z"></path></svg>
                                    <svg class="pause-icon player-icon hidden" viewBox="0 0 24 24" fill="currentColor"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"></path></svg>
                                </button>
                                <button id="next-btn" class="player-btn">
                                    <svg class="player-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 4 15 12 5 20 5 4"></polygon><line x1="19" y1="5" x2="19" y2="19"></line></svg>
                                </button>
                            </div>
                            <div class="volume-container">
                                <div id="volume-icon-container">
                                    <svg id="volume-icon-up" class="player-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path></svg>
                                    <svg id="volume-icon-mute" class="player-icon hidden" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><line x1="23" y1="9" x2="17" y2="15"></line><line x1="17" y1="9" x2="23" y2="15"></line></svg>
                                </div>
                                <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="1">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Console View -->
            <div id="console-view" class="view">
                <h2>Console Output</h2>
                <div id="download-progress-container" class="hidden">
                    <div class="progress-bar-wrapper">
                        <div id="download-progress-bar"></div>
                    </div>
                    <span id="download-eta"></span>
                </div>
                <div id="console-output" class="console-output"></div>
                <button id="big-cancel-btn" class="hidden">Cancel Download</button>
                <button id="create-playlist-btn" class="hidden">Create Playlist</button>
            </div>

            <!-- Help View -->
            <div id="help-view" class="view">
                <h1>Help</h1>
                <h2>How to get Spotify Credentials</h2>
                <ol class="help-list">
                    <li>Go to the Spotify Developer Dashboard: <a href="#" id="spotify-link">developer.spotify.com/dashboard</a></li>
                    <li>Log in with your Spotify account.</li>
                    <li>Click the "Create App" button.</li>
                    <li>Give your app a name and description (e.g., "SoundLink") and check the boxes to agree to the terms.</li>
                    <li>Once created, you will see your <strong>Client ID</strong> on the dashboard. Click "Show client secret" to see your <strong>Client Secret</strong>.</li>
                    <li>Copy and paste both of these values into the Settings tab of this application.</li>
                </ol>
            </div>

            <!-- Notification History View -->
            <div id="notification-history-view" class="view">
                <div class="history-header">
                    <h1>Notification History</h1>
                    <button id="clear-history-btn" class="secondary-btn">Clear History</button>
                </div>
                <div id="notification-history-container" class="notification-history-container">
                    <!-- History items will be injected here -->
                </div>
            </div>
        </div>
    </div>
    <div id="app-dialog-modal" class="modal hidden">
        <div class="modal-content app-dialog-content">
            <h2 id="app-dialog-title">Confirm</h2>
            <p id="app-dialog-message"></p>
            <input id="app-dialog-input" type="text" class="hidden" />
            <div class="modal-buttons">
                <button id="app-dialog-cancel-btn" class="cancel-btn">Cancel</button>
                <button id="app-dialog-confirm-btn">Confirm</button>
            </div>
        </div>
    </div>
    <div id="mix-details-modal" class="modal hidden">
        <div class="modal-content mix-details-modal-content">
            <span id="mix-details-close-btn" class="modal-close-btn" aria-label="Close">&times;</span>
            <h2 id="mix-details-title">Mix Details</h2>
            <p id="mix-details-summary" class="mix-details-summary"></p>
            <div class="mix-details-toolbar">
                <button id="mix-details-save-btn" type="button" class="secondary-btn">Save as new playlist</button>
            </div>
            <div id="mix-details-content" class="mix-details-content"></div>
        </div>
    </div>
    <div id="context-menu" class="context-menu hidden"></div>
    <script src="renderer.js" type="module"></script>
</body>
</html>